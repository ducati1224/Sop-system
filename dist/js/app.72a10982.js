(function(t){function e(e){for(var a,i,o=e[0],c=e[1],l=e[2],d=0,f=[];d<o.length;d++)i=o[d],s[i]&&f.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,o=1;o<r.length;o++){var c=r[o];0!==s[c]&&(a=!1)}a&&(n.splice(e--,1),t=i(i.s=r[0]))}return t}var a={},s={app:0},n=[];function i(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=a,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(r,a,function(e){return t[e]}.bind(null,a));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"039a":function(t,e,r){"use strict";var a=r("fb8f"),s=r.n(a);s.a},"1f0b":function(t,e,r){"use strict";var a=r("c759"),s=r.n(a);s.a},2856:function(t,e,r){},2920:function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("744f"),r("6c7b"),r("7514"),r("20d6"),r("1c4c"),r("6762"),r("cadf"),r("e804"),r("55dd"),r("d04f"),r("c8ce"),r("217b"),r("7f7f"),r("f400"),r("7f25"),r("536b"),r("d9ab"),r("f9ab"),r("32d7"),r("25c9"),r("9f3c"),r("042e"),r("c7c6"),r("f4ff"),r("049f"),r("7872"),r("a69f"),r("0b21"),r("6c1a"),r("c7c62"),r("84b4"),r("c5f6"),r("2e37"),r("fca0"),r("7cdf"),r("ee1d"),r("b1b1"),r("87f3"),r("9278"),r("5df2"),r("04ff"),r("f751"),r("4504"),r("fee7"),r("ffc1"),r("0d6d"),r("9986"),r("8e6e"),r("25db"),r("e4f7"),r("b9a1"),r("64d5"),r("9aea"),r("db97"),r("66c8"),r("57f0"),r("165b"),r("456d"),r("cf6a"),r("fd24"),r("8615"),r("551c"),r("097d"),r("df1b"),r("2397"),r("88ca"),r("ba16"),r("d185"),r("ebde"),r("2d34"),r("f6b3"),r("2251"),r("c698"),r("a19f"),r("9253"),r("9275"),r("3b2b"),r("3846"),r("4917"),r("a481"),r("28a5"),r("386d"),r("6b54"),r("4f7f"),r("8a81"),r("ac4d"),r("8449"),r("9c86"),r("fa83"),r("48c0"),r("a032"),r("aef6"),r("d263"),r("6c37"),r("9ec8"),r("5695"),r("2fdb"),r("d0b0"),r("b54a"),r("f576"),r("ed50"),r("788d"),r("14b9"),r("f386"),r("f559"),r("1448"),r("673e"),r("242a"),r("c66f"),r("b05c"),r("34ef"),r("6aa2"),r("15ac"),r("af56"),r("b6e4"),r("9c29"),r("63d9"),r("4dda"),r("10ad"),r("c02b"),r("4795"),r("130f"),r("ac6a"),r("96cf");var a=r("2b0e"),s=r("ce5b"),n=r.n(s);r("bf40");a["default"].use(n.a,{});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",{attrs:{id:"inspire"}},[r("v-toolbar",{attrs:{color:"indigo",dark:"",fixed:"",app:""}},[r("v-btn",{attrs:{flat:"",icon:"",color:"white",to:"/sop"}},[r("v-icon",[t._v("assignment")])],1),r("v-toolbar-title",[t._v("SOP 表單查詢系統")]),r("v-spacer"),t.isLogin?[r("v-btn",{attrs:{color:"indigo",depressed:"","active-class":"none"},on:{click:t.logout}},[r("v-icon",[t._v("input")]),t._v(" 登出\n      ")],1)]:t._e(),t.isLogin?t._e():[r("v-btn",{attrs:{color:"indigo",depressed:"",to:"/","active-class":"none"}},[r("v-icon",[t._v("account_box")]),t._v(" 登入\n      ")],1)]],2),r("v-content",[r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{"justify-center":""}},[r("v-flex",{attrs:{md8:""}},[r("show-error"),r("router-view")],1)],1)],1)],1),r("v-footer",{attrs:{color:"indigo",app:""}},[r("span",{staticClass:"white--text text-xs-center copyright"},[t._v("Copyright © 2018 Leegood Automatic System Inc. All Rights Reserved.")])])],1)},o=[],c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-snackbar",{attrs:{"multi-line":"",top:"",right:"",timeout:3e3,color:"blue-grey darken-1"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n  "+t._s(t.errMessage)+"\n")])},l=[],u={data:function(){return{snackbar:!1}},computed:{errMessage:function(){return this.$store.getters["getErrMessage"]},errStatus:function(){return this.$store.getters["getErrStatus"]}},watch:{errStatus:function(t,e){t&&(this.snackbar=!0,this.$store.commit("setErrStatus",!1))}}},d=u,f=(r("d614"),r("2877")),p=Object(f["a"])(d,c,l,!1,null,null,null);p.options.__file="ShowError.vue";var v=p.exports,h={data:function(){return{}},methods:{redirect:function(t){this.$router.push(t)},logout:function(){this.$store.commit("setUser",{username:null,isAuthorized:!1,token:null}),this.$store.commit("setErrMessage",{errMessage:"登出成功",errStatus:!0}),this.$router.push("/sop")}},computed:{isLogin:function(){return this.$store.getters["getUser"].isAuthorized}},components:{ShowError:v}},m=h,g=(r("5c0b"),Object(f["a"])(m,i,o,!1,null,null,null));g.options.__file="App.vue";var b=g.exports,_=r("8c4f"),x=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{"pa-0":""}},[r("v-layout",[r("v-flex",[r("router-view")],1)],1)],1)},w=[],k={},y=k,$=(r("1f0b"),Object(f["a"])(y,x,w,!1,null,null,null));$.options.__file="Sop.vue";var L=$.exports,S=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),r("div",{staticClass:"content elevation-12"},[r("v-layout",{attrs:{"align-center":""}},[t.isLogin?r("v-flex",[r("v-btn",{attrs:{flat:"",color:"primary",to:"/sop/edit/"+t.params}},[t._v("編輯"),r("v-icon",{attrs:{right:""}},[t._v("create")])],1),r("v-btn",{attrs:{flat:"",color:"error"},on:{click:t.deleteSop}},[t._v("刪除"),r("v-icon",{attrs:{right:""}},[t._v("delete")])],1)],1):t._e(),r("v-spacer"),r("v-flex",{class:{read:!t.isLogin}},[r("p",{staticClass:"text-xs-right title font-weight-black sop__wording"},[t._v("STANDARD OPERATING PROCEDURE")])])],1),r("v-layout",{staticClass:"content__table",attrs:{row:"",wrap:"","mb-4":""}},[r("v-flex",{staticClass:"content__item content__item--th",attrs:{xs3:""}},[r("span",{staticClass:"content__item--title"},[t._v("警報編號")])]),r("v-flex",{staticClass:"content__item content__item--th",attrs:{xs3:""}},[r("span",{staticClass:"content__item--title"},[t._v("描述")])]),r("v-flex",{staticClass:"content__item content__item--th",attrs:{xs3:""}},[r("span",{staticClass:"content__item--title"},[t._v("附件數量")])]),r("v-flex",{staticClass:"content__item content__item--th",attrs:{xs3:""}},[r("span",{staticClass:"content__item--title"},[t._v("建立日期")])]),r("v-flex",{staticClass:"content__item",attrs:{xs3:""}},[r("span",{staticClass:"break"},[t._v(t._s(t.sqlData.alarmId))])]),r("v-flex",{staticClass:"content__item",attrs:{xs3:""}},[r("span",{staticClass:"break"},[t._v(t._s(t.sqlData.description))])]),r("v-flex",{staticClass:"content__item",attrs:{xs3:""}},[r("span",{staticClass:"break"},[t._v(t._s(t.sqlData.files?t.sqlData.files.length:"0"))])]),r("v-flex",{staticClass:"content__item",attrs:{xs3:""}},[r("span",{staticClass:"break"},[t._v(t._s(t.sqlData.date))])])],1),r("div",{staticClass:"procedure"},[r("p",{staticClass:"subheading font-weight-bold"},[t._v("處理流程")]),r("v-list",{attrs:{"two-line":""}},[t._l(t.sqlData.detail,function(t,e){return[r("v-list-tile",{key:e},[r("v-list-tile-content",[r("v-checkbox",{attrs:{label:t,color:"success",light:""}})],1)],1)]})],2)],1),r("div",{staticClass:"appendix"},[r("p",{staticClass:"subheading font-weight-bold"},[t._v("檔案附件")]),r("v-layout",{attrs:{row:"",wrap:""}},[t._l(t.sqlData.fileName,function(e,a){return[r("v-flex",{key:a,attrs:{xs12:"",sm4:"",md3:""}},[r("div",{staticClass:"text-xs-center"},[r("v-chip",{attrs:{outline:"",color:"blue-grey darken-1"}},[r("a",{staticClass:"appendix__download",attrs:{href:t.baseUrl+"uploads/"+e,download:e}},[t._v("\n                  "+t._s(e.length>10?e.substring(0,10)+"...":e)+"\n                  "),r("v-avatar",[r("v-icon",{attrs:{color:"blue-grey darken-1",right:""}},[t._v("cloud_download")])],1)],1)])],1)])]})],2)],1)],1)],1)},M=[],E=r("a34a"),C=r.n(E),O=r("3040"),j=r("bc3a"),I=r.n(j),D={data:function(){return{params:this.$route.params.alarmId,isLoading:!1,baseUrl:"/",sqlData:{}}},methods:{fetchData:function(){var t=Object(O["a"])(C.a.mark(function t(){var e,r,a,s,n,i,o,c,l;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isLoading=!0,t.next=4,I.a.get("".concat(window.location.origin,"/sop/").concat(this.params));case 4:e=t.sent,e.data.length?(r=e.data[0],a=r.alarmId,s=r.description,n=r.detail.split("\n"),i=new Date(Number(r.date)),o="".concat(i.getFullYear(),"/").concat(i.getMonth()+1,"/").concat(i.getDate()),r.files&&(c=JSON.parse(r.files).dest,l=c.map(function(t){return t.slice(8)})),this.sqlData={alarmId:a,description:s,detail:n,files:c,fileName:l,date:o},this.isLoading=!1):(this.$store.commit("setErrMessage",{errMessage:"查無資料",errStatus:!0}),this.isLoading=!1,this.$router.push("/sop")),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),this.$store.commit("setErrMessage",{errMessage:t.t0.response.data.error.message||"Something went wrong...",errStatus:!0}),this.isLoading=!1;case 12:case"end":return t.stop()}},t,this,[[0,8]])}));return function(){return t.apply(this,arguments)}}(),deleteSop:function(){var t=Object(O["a"])(C.a.mark(function t(){return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!window.confirm("確定要刪除SOP編號".concat(this.params,"嗎？\n刪除後無法復原"))){t.next=10;break}return this.isLoading=!0,t.next=5,I.a.delete("".concat(window.location.origin,"/sop/").concat(this.params),{headers:{Authorization:"Bearer ".concat(this.$store.getters["getUser"].token)}});case 5:this.$store.commit("setErrMessage",{errMessage:null,errStatus:!1}),this.isLoading=!1,this.$router.push("/sop"),t.next=12;break;case 10:return this.isLoading=!1,t.abrupt("return");case 12:t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$store.commit("setErrMessage",{errMessage:t.t0.response.data.error.message,errStatus:!0}),this.isLoading=!1,this.$router.push("/");case 19:case"end":return t.stop()}},t,this,[[0,14]])}));return function(){return t.apply(this,arguments)}}()},computed:{isLogin:function(){return this.$store.getters["getUser"].isAuthorized}},created:function(){this.fetchData()}},F=D,A=(r("f628"),Object(f["a"])(F,S,M,!1,null,"00ae6579",null));A.options.__file="SopDetail.vue";var z=A.exports,U=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-list",{staticClass:"list",attrs:{subheader:"","three-line":""}},[r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),r("v-layout",{attrs:{row:"","justify-start":"","mp-4":"","align-center":""}},[r("v-flex",[r("span",{staticClass:"display-2"},[t._v("SOP 列表")]),r("v-btn",{attrs:{flat:"",icon:"",color:"primary"},on:{click:t.fetchData}},[r("v-icon",[t._v("cached")])],1)],1),r("v-spacer"),t.isLogin?[r("v-btn",{attrs:{flat:"",color:"primary",to:"/sop/new"}},[r("v-icon",{attrs:{left:""}},[t._v("add_circle_outline")]),t._v("新增表單\n      ")],1)]:t._e()],2),t._l(t.sqlData,function(e,a){return[r("v-list-tile",{key:e.alarmId,attrs:{to:"/sop/"+e.alarmId}},[r("v-list-tile-content",[r("v-list-tile-title",[t._v(t._s(e.alarmId))]),r("v-list-tile-sub-title",[t._v("\n          "+t._s(e.description)+"\n        ")])],1)],1),r("v-divider",{key:a})]})],2)},q=[],P={data:function(){return{sqlData:[],isLoading:!1}},methods:{fetchData:function(){var t=Object(O["a"])(C.a.mark(function t(){var e;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isLoading=!0,t.next=4,I.a.get("".concat(window.location.origin,"/sop/list"));case 4:e=t.sent,this.sqlData=e.data,this.isLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),this.$store.commit("setErrMessage",{errMessage:"資料庫無回應，請確認網路連線。",errStatus:!0}),this.isLoading=!1;case 13:case"end":return t.stop()}},t,this,[[0,9]])}));return function(){return t.apply(this,arguments)}}()},computed:{isLogin:function(){return this.$store.getters["getUser"].isAuthorized}},created:function(){this.fetchData()}},N=P,T=(r("d892"),Object(f["a"])(N,U,q,!1,null,"23be6012",null));T.options.__file="SopList.vue";var R=T.exports,B=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:"","fill-height":""}},[r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",md8:"",lg6:""}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{dark:"",color:"indigo"}},[r("v-toolbar-title",[t._v("管理者登入")])],1),r("v-card-text",[r("v-form",[r("v-text-field",{attrs:{"prepend-icon":"person",name:"login",label:"帳號",type:"text"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),r("v-text-field",{attrs:{id:"password","prepend-icon":"lock",name:"password",label:"密碼",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"primary"},on:{click:t.submit}},[t._v("登入")])],1)],1)],1)],1)],1)},J=[],V={data:function(){return{username:"",password:"",isLoading:!1}},methods:{submit:function(){var t=Object(O["a"])(C.a.mark(function t(){var e,r;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isLoading=!0,e={username:this.username,password:this.password},t.next=5,I.a.post("".concat(window.location.origin,"/user/signin"),e);case 5:r=t.sent,this.$store.commit("setUser",{username:r.data.username,isAuthorized:!0,token:r.data.token}),this.$store.commit("setErrMessage",{errMessage:"登入成功",errStatus:!0}),this.isLoading=!1,this.$router.push("/sop"),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),this.$store.commit("setUser",{username:null,isAuthorized:!1,token:null}),this.$store.commit("setErrMessage",{errMessage:t.t0.response.data.error.message||"Something went wrong...",errStatus:!0}),this.isLoading=!1;case 17:case"end":return t.stop()}},t,this,[[0,12]])}));return function(){return t.apply(this,arguments)}}()}},G=V,Y=(r("039a"),Object(f["a"])(G,B,J,!1,null,null,null));Y.options.__file="Login.vue";var H=Y.exports,K=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),r("v-card",{staticClass:"form elevation-12",attrs:{"max-width":"1000"}},[r("v-toolbar",{attrs:{cards:"",flat:"",color:"teal lighten-4"}},[r("v-btn",{attrs:{icon:""}},[r("v-icon",{attrs:{color:"light-blue accent-3"}},[t._v("edit")])],1),r("v-card-title",{staticClass:"title font-weight-regular"},[t._v("新增表單")])],1),r("v-snackbar",{attrs:{absolute:"",top:"",right:"",color:"success"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[r("span",[t._v("送出成功！！")]),r("v-icon",{attrs:{dark:""}},[t._v("check_circle")])],1),r("v-form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[r("v-container",{attrs:{"grid-list-xl":"",fluid:"","px-5":""}},[r("v-layout",{attrs:{wrap:""}},[r("v-flex",{attrs:{xs12:"",sm6:""}},[r("v-text-field",{attrs:{rules:t.rules.name,color:"blue darken-2",label:"警報編號",required:""},model:{value:t.form.alarmId,callback:function(e){t.$set(t.form,"alarmId",e)},expression:"form.alarmId"}})],1),r("v-flex",{attrs:{xs12:"",sm6:""}},[r("v-text-field",{attrs:{rules:t.rules.name,color:"blue darken-2",label:"警報描述",required:""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-textarea",{attrs:{color:"blue darken-2",rules:t.rules.name,required:"","auto-grow":""},model:{value:t.form.detail,callback:function(e){t.$set(t.form,"detail",e)},expression:"form.detail"}},[r("div",{attrs:{slot:"label"},slot:"label"},[t._v("\n                處理步驟\n              ")])])],1),r("v-flex",{attrs:{xs12:""}},[r("label",[r("v-chip",{attrs:{color:"light-blue darken-4","text-color":"white"}},[r("v-avatar",[r("v-icon",[t._v("cloud_upload")])],1),t._v("\n                上傳檔案\n              ")],1),r("input",{ref:"uploadFiles",staticStyle:{display:"none"},attrs:{type:"file",id:"file",multiple:""},on:{change:t.handleFileUpload}})],1),t._l(t.form.files,function(e,a){return r("v-chip",{key:a,attrs:{outline:"",label:"",color:"blue-grey darken-1"}},[r("v-avatar",[r("v-icon",{attrs:{color:"blue-grey darken-1"}},[t._v("attach_file")])],1),t._v(t._s(e.name)+"\n              ")],1)})],2),r("v-flex",{attrs:{xs12:""}},[r("v-card-actions",[r("v-btn",{on:{click:t.resetForm}},[t._v("重新填寫")]),r("v-spacer"),r("v-btn",{attrs:{disabled:!t.formIsValid,color:"primary"},on:{click:t.submit}},[t._v("送出")])],1)],1)],1)],1)],1)],1)],1)},Q=[],W={data:function(){var t=Object.freeze({alarmId:"",description:"",detail:"",files:[]});return{form:Object.assign({},t),rules:{name:[function(t){return(t||"").length>0||"此欄不能為空"}]},snackbar:!1,defaultForm:t,isLoading:!1}},computed:{formIsValid:function(){return this.form.alarmId&&this.form.description&&this.form.detail}},methods:{resetForm:function(){this.form=Object.assign({},this.defaultForm),this.$refs.form.reset(),this.$refs.uploadFiles.value=""},submit:function(){var t=Object(O["a"])(C.a.mark(function t(){var e,r,a;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(t.prev=0,this.snackbar=!0,this.isLoading=!0,e=new FormData,r=0;r<this.form.files.length;r++)a=this.form.files[r],e.append("file",a);return e.append("alarmId",this.form.alarmId),e.append("description",this.form.description),e.append("detail",this.form.detail),t.next=10,I.a.post("".concat(window.location.origin,"/sop/"),e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(this.$store.getters["getUser"].token)}});case 10:this.isLoading=!1,this.$router.push("/sop"),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$store.commit("setErrMessage",{errMessage:t.t0.response.data.error.message||"Something went wrong...",errStatus:!0}),this.isLoading=!1;case 18:case"end":return t.stop()}},t,this,[[0,14]])}));return function(){return t.apply(this,arguments)}}(),handleFileUpload:function(){this.form.files=this.$refs.uploadFiles.files}}},X=W,Z=(r("5bc4"),Object(f["a"])(X,K,Q,!1,null,"e092297c",null));Z.options.__file="SopForm.vue";var tt=Z.exports,et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),r("v-card",{staticClass:"form elevation-12",attrs:{"max-width":"1000"}},[r("v-toolbar",{attrs:{cards:"",flat:"",color:"teal lighten-4"}},[r("v-btn",{attrs:{icon:""}},[r("v-icon",{attrs:{color:"light-blue accent-3"}},[t._v("edit")])],1),r("v-card-title",{staticClass:"title font-weight-regular"},[t._v("編輯表單")])],1),r("v-snackbar",{attrs:{absolute:"",top:"",right:"",color:"success"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[r("span",[t._v("處理中...")]),r("v-icon",{attrs:{dark:""}},[t._v("check_circle")])],1),r("v-form",{ref:"editForm",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[r("v-container",{attrs:{"grid-list-xl":"",fluid:"","px-5":""}},[r("v-layout",{attrs:{wrap:""}},[r("v-flex",{attrs:{xs12:"",sm6:""}},[r("v-text-field",{attrs:{rules:t.rules.name,color:"blue darken-2",label:"警報編號",required:""},model:{value:t.form.alarmId,callback:function(e){t.$set(t.form,"alarmId",e)},expression:"form.alarmId"}})],1),r("v-flex",{attrs:{xs12:"",sm6:""}},[r("v-text-field",{attrs:{rules:t.rules.name,color:"blue darken-2",label:"警報描述",required:""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-textarea",{attrs:{color:"blue darken-2",rules:t.rules.name,required:"","auto-grow":""},model:{value:t.form.detail,callback:function(e){t.$set(t.form,"detail",e)},expression:"form.detail"}},[r("div",{attrs:{slot:"label"},slot:"label"},[t._v("\n                處理步驟\n              ")])])],1),r("v-flex",{attrs:{xs12:""}},[r("label",[r("v-chip",{attrs:{color:"light-blue darken-4","text-color":"white"}},[r("v-avatar",[r("v-icon",[t._v("cloud_upload")])],1),t._v("\n                上傳檔案\n              ")],1),r("input",{ref:"editFiles",staticStyle:{display:"none"},attrs:{type:"file",id:"file",multiple:""},on:{change:t.handleFileUpload}})],1),t._l(t.form.files,function(e,a){return r("v-chip",{key:a,attrs:{outline:"",label:"",color:"blue-grey darken-1"}},[r("v-avatar",[r("v-icon",{attrs:{color:"blue-grey darken-1"}},[t._v("attach_file")])],1),t._v(t._s(e.name)+"\n              ")],1)})],2),r("v-flex",{attrs:{xs12:""}},[r("v-card-actions",[r("v-btn",{on:{click:t.resetForm}},[t._v("重新填寫")]),r("v-spacer"),r("v-btn",{attrs:{disabled:!t.formIsValid,color:"primary"},on:{click:t.submit}},[t._v("送出")])],1)],1)],1)],1)],1)],1)],1)},rt=[],at={data:function(){return{form:{},rules:{name:[function(t){return(t||"").length>0||"此欄不能為空"}]},snackbar:!1,defaultForm:{},isLoading:!1}},computed:{formIsValid:function(){return this.form.alarmId&&this.form.description&&this.form.detail}},methods:{resetForm:function(){this.form=Object.assign({},this.defaultForm),this.$refs.editFiles.value=""},submit:function(){var t=Object(O["a"])(C.a.mark(function t(){var e,r,a;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,this.isLoading=!0,this.snackbar=!0,e=new FormData,this.$refs.editFiles.files.length)for(r=0;r<this.form.files.length;r++)a=this.form.files[r],e.append("file",a);return e.append("alarmId",this.form.alarmId),e.append("description",this.form.description),e.append("detail",this.form.detail),t.next=10,I.a.put("".concat(window.location.origin,"/sop/").concat(this.$route.params.alarmId),e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(this.$store.getters["getUser"].token)}});case 10:this.isLoading=!1,this.$router.push("/sop"),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$store.commit("setErrMessage",{errMessage:t.t0.response.data.error.message||"Something went wrong...",errStatus:!0}),this.isLoading=!1;case 18:case"end":return t.stop()}},t,this,[[0,14]])}));return function(){return t.apply(this,arguments)}}(),handleFileUpload:function(){this.form.files=this.$refs.editFiles.files},fetchData:function(){var t=Object(O["a"])(C.a.mark(function t(){var e,r,a,s,n,i,o;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isLoading=!0,t.next=4,I.a.get("".concat(window.location.origin,"/sop/").concat(this.$route.params.alarmId));case 4:e=t.sent,e.data.length?(r=e.data[0],a=r.alarmId,s=r.description,n=r.detail,r.files&&(i=JSON.parse(r.files).dest,o=i.map(function(t){return{name:t.slice(8)}})),this.defaultForm={alarmId:a,description:s,detail:n,files:o},this.resetForm(),this.isLoading=!1):(this.$store.commit("setErrMessage",{errMessage:"查無資料",errStatus:!0}),this.isLoading=!1,this.$router.push("/sop")),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),this.$store.commit("setErrMessage",{errMessage:t.t0.response.data.error.message||"Something went wrong...",errStatus:!0}),this.isLoading=!1;case 12:case"end":return t.stop()}},t,this,[[0,8]])}));return function(){return t.apply(this,arguments)}}()},created:function(){this.fetchData()}},st=at,nt=(r("af8a"),Object(f["a"])(st,et,rt,!1,null,"01d9816b",null));nt.options.__file="SopEdit.vue";var it=nt.exports,ot=r("2f62");a["default"].use(ot["a"]);var ct=new ot["a"].Store({state:{user:null,isAuthorized:!1,token:null,errMessage:null,error:!1},mutations:{setUser:function(t,e){t.user=e.username,t.isAuthorized=e.isAuthorized,t.token=e.token},setErrMessage:function(t,e){t.errMessage=e.errMessage,t.error=e.errStatus},setErrStatus:function(t,e){t.error=e}},getters:{getUser:function(t){return{user:t.user,isAuthorized:t.isAuthorized,token:t.token}},getErrMessage:function(t){return t.errMessage},getErrStatus:function(t){return t.error}},actions:{signin:function(){var t=Object(O["a"])(C.a.mark(function t(e,r){var a,s;return C.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,t.prev=1,t.next=4,I.a.post("".concat(window.location.origin,"/user/signin"),r);case 4:s=t.sent,a("setUser",{username:s.data.username,isAuthorized:!0,token:s.data.token}),a("setErrMessage",{errMessage:null,errStatus:!1}),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),a("setUser",{username:null,isAuthorized:!1,token:null}),a("setErrMessage",{errMessage:t.t0.response.data.error.message,errStatus:!0});case 13:case"end":return t.stop()}},t,this,[[1,9]])}));return function(e,r){return t.apply(this,arguments)}}()}});a["default"].use(_["a"]);var lt=new _["a"]({mode:"history",base:"/",routes:[{path:"/sop",component:L,children:[{path:"",name:"List",component:R},{path:"new",name:"Form",component:tt,beforeEnter:function(t,e,r){ct.state.isAuthorized?r():r("/")}},{path:"edit/:alarmId",name:"Edit",component:it,beforeEnter:function(t,e,r){ct.state.isAuthorized?r():r("/")}},{path:":alarmId",component:z}]},{path:"/",component:H,beforeEnter:function(t,e,r){ct.state.isAuthorized?r("/sop"):r()}}]}),ut=r("9483");Object(ut["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var dt=r("9062"),ft=r.n(dt);r("bd0f"),r("15f5"),r("d1e7");a["default"].component("Loading",ft.a),a["default"].config.productionTip=!1,new a["default"]({router:lt,store:ct,render:function(t){return t(b)}}).$mount("#app")},"5bc4":function(t,e,r){"use strict";var a=r("b72f"),s=r.n(a);s.a},"5c0b":function(t,e,r){"use strict";var a=r("2856"),s=r.n(a);s.a},"62f0":function(t,e,r){},"73dc":function(t,e,r){},"7afc":function(t,e,r){},af8a:function(t,e,r){"use strict";var a=r("62f0"),s=r.n(a);s.a},b72f:function(t,e,r){},c759:function(t,e,r){},d614:function(t,e,r){"use strict";var a=r("73dc"),s=r.n(a);s.a},d892:function(t,e,r){"use strict";var a=r("7afc"),s=r.n(a);s.a},f628:function(t,e,r){"use strict";var a=r("2920"),s=r.n(a);s.a},fb8f:function(t,e,r){}});
//# sourceMappingURL=app.72a10982.js.map